{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup",
        "hooks": [
          {
            "type": "command",
            "command": "BRANCH=$(git rev-parse --abbrev-ref HEAD 2>/dev/null | tr '/' '-'); if [ -n \"$BRANCH\" ] && [ -f \".planning/STATE-${BRANCH}.md\" ]; then echo \"PROJECT CONTEXT: .planning/STATE-${BRANCH}.md exists for this branch. Run /load-context for a full briefing.\"; elif [ -d .planning ]; then echo 'PROJECT CONTEXT: .planning/ exists but no state file for this branch yet. Run /load-context to see shared decisions and research.'; fi"
          }
        ]
      },
      {
        "matcher": "resume",
        "hooks": [
          {
            "type": "command",
            "command": "BRANCH=$(git rev-parse --abbrev-ref HEAD 2>/dev/null | tr '/' '-'); if [ -n \"$BRANCH\" ] && [ -f \".planning/STATE-${BRANCH}.md\" ]; then echo \"SESSION RESUMED â€” .planning/STATE-${BRANCH}.md exists. Read it to recover context from the previous session.\"; fi"
          }
        ]
      },
      {
        "matcher": "compact",
        "hooks": [
          {
            "type": "command",
            "command": "echo '--- MANDATORY RULES (re-injected after compaction) ---'; echo 'You MUST follow these rules for the remainder of this session:'; echo '1. COMMIT after every completed unit of work. Do not batch commits. Do not wait to be asked.'; echo '2. CHECKPOINT (/checkpoint) when: a decision is made, a dead end is hit, scope is clarified, a bug root cause is found, or the session is wrapping up.'; echo '3. SAVE DECISIONS (/save-decision) when architectural or design choices are made. Persist them, do not just discuss them.'; echo '4. Run lint, test, and build commands before considering work done.'; echo '--- END MANDATORY RULES ---'; echo ''; BRANCH=$(git rev-parse --abbrev-ref HEAD 2>/dev/null | tr '/' '-'); if [ -n \"$BRANCH\" ] && [ -f \".planning/STATE-${BRANCH}.md\" ]; then echo '--- CONTEXT RECOVERED AFTER COMPACTION ---'; cat \".planning/STATE-${BRANCH}.md\"; echo '--- END RECOVERED CONTEXT ---'; fi"
          }
        ]
      }
    ]
  },
  "permissions": {
    "allow": [
      "Bash(git add:*)",
      "Bash(git branch:*)",
      "Bash(git checkout:*)",
      "Bash(git commit:*)",
      "Bash(git diff:*)",
      "Bash(git log:*)",
      "Bash(git pull:*)",
      "Bash(git push:*)",
      "Bash(git rebase:*)",
      "Bash(git reset:*)",
      "Bash(git stash:*)",
      "Bash(git status:*)",
      "Bash(git worktree:*)",
      "Bash(gh:*)",
      "Bash(npm install:*)",
      "Bash(npm run build:*)",
      "Bash(npx tsc:*)",
      "Bash(npx next lint)",
      "Bash(pnpm add:*)",
      "Bash(pnpm build)",
      "Bash(pnpm run build:*)",
      "Bash(pnpm lint:*)",
      "Bash(pnpm exec tsc:*)",
      "Bash(yarn add:*)",
      "Bash(python3:*)",
      "Bash(python -c:*)",
      "Bash(python -m json.tool:*)",
      "Bash(uv run:*)",
      "Bash(uv pip install:*)",
      "Bash(uv sync:*)",
      "Bash(supabase:*)",
      "Bash(psql:*)",
      "Bash(pg_dump:*)",
      "Bash(docker run:*)",
      "Bash(node -e:*)",
      "Bash(curl:*)",
      "Bash(ls:*)",
      "Bash(find:*)",
      "Bash(grep:*)",
      "Bash(cat:*)",
      "Bash(sort:*)",
      "Bash(wc:*)",
      "Bash(du:*)",
      "Bash(jq:*)",
      "Bash(xargs:*)",
      "Bash(chmod:*)",
      "Bash(tee:*)",
      "Bash(pgrep:*)",
      "Bash(ps:*)",
      "Bash(unset:*)",
      "Bash(host:*)",
      "Bash(dig:*)",
      "Bash(ping6:*)",
      "Bash(identify:*)",
      "WebSearch"
    ],
    "deny": [
      "Bash(supabase db reset:*)"
    ],
    "defaultMode": "default"
  }
}
